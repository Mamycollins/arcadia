<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Dashboard Vétérinaire - Zoo Arcadia</title>
    <link rel="stylesheet" href="/style.css">
</head>
<body class="accueil-body" onload="includeHTML()">
    <header w3-include-html="/assets/header.html"></header>

    <main>
        <section class="vet-section">
            <h2>Bienvenue, Vétérinaire</h2>
            <p>Utilisez les options ci-dessous pour gérer la santé des animaux.</p>
        </section>

        <!-- Section Gestion des Dossiers Médicaux -->
        <section class="management-section">
            <h3>Gestion des Dossiers Médicaux</h3>
            <form id="medical-record-form">
                <div class="form-group">
                    <label for="animal-id">ID de l'Animal :</label>
                    <input type="text" id="animal-id" required>
                </div>
                <div class="form-group">
                    <label for="animal-name">Nom de l'Animal :</label>
                    <input type="text" id="animal-name" required>
                </div>
                <div class="form-group">
                    <label for="medical-notes">Notes Médicales :</label>
                    <textarea id="medical-notes" required></textarea>
                </div>
                <div class="form-group">
                    <label for="appointment-date">Prochain rdv :</label>
                    <input type="date" id="appointment-date" required>
                </div>
                <button type="button" onclick="addMedicalRecord()">Ajouter Dossier Médical</button>
            </form>
            <div id="medical-record-list">
                <!-- Liste des dossiers médicaux dynamiquement remplie par JavaScript -->
            </div>
        </section>

        <!-- Section Informations Utiles -->
        <section class="management-section">
            <h3>Informations Utiles</h3>
            <div id="useful-info">
                <!-- Contenu dynamiquement rempli par JavaScript -->
            </div>
        </section>
    </main>

    <footer w3-include-html="/assets/footer.html"></footer>

    <script src="/js/include.js"></script>
    <script src="/js/script.js"></script>
    <script>
        function addMedicalRecord() {
            const animalId = document.getElementById('animal-id').value;
            const animalName = document.getElementById('animal-name').value;
            const medicalNotes = document.getElementById('medical-notes').value;
            const appointmentDate = document.getElementById('appointment-date').value;
            const medicalRecordList = document.getElementById('medical-record-list');

            if (animalId && animalName && medicalNotes && appointmentDate) {
                const recordItem = document.createElement('div');
                recordItem.className = 'record-item';
                recordItem.innerHTML = `<p>ID de l'Animal: ${animalId}</p>
                                        <p>Nom de l'Animal: ${animalName}</p>
                                        <p>Notes Médicales: ${medicalNotes}</p>
                                        <p>Date du Rendez-vous: ${appointmentDate}</p>
                                        <button onclick="deleteMedicalRecord(this)">Supprimer</button>`;
                medicalRecordList.appendChild(recordItem);

                // Enregistrer le dossier médical dans le localStorage
                let medicalRecords = JSON.parse(localStorage.getItem('medicalRecords')) || [];
                medicalRecords.push({ animalId, animalName, medicalNotes, appointmentDate });
                localStorage.setItem('medicalRecords', JSON.stringify(medicalRecords));

                // Réinitialiser le formulaire
                document.getElementById('medical-record-form').reset();
            } else {
                alert('Veuillez remplir tous les champs.');
            }
        }

        function deleteMedicalRecord(button) {
            const recordItem = button.parentNode;
            const animalId = recordItem.querySelector('p').innerText.split(': ')[1];
            let medicalRecords = JSON.parse(localStorage.getItem('medicalRecords')) || [];
            medicalRecords = medicalRecords.filter(record => record.animalId !== animalId);
            localStorage.setItem('medicalRecords', JSON.stringify(medicalRecords));
            recordItem.remove();
        }

        document.addEventListener('DOMContentLoaded', function() {
            const usefulInfoDiv = document.getElementById('useful-info');
            const usefulInfoData = {
                emergencyContact: 'Contact d\'urgence : 01 23 45 67 89',
                nextCheckup: 'Prochain contrôle de routine : 15/08/2024',
                vaccinationSchedule: 'Calendrier de vaccination : Vérifiez les dossiers médicaux pour les dates spécifiques.'
            }; // Exemple de données

            usefulInfoDiv.innerHTML = `
                <p>Contact d'urgence : ${usefulInfoData.emergencyContact}</p>
                <p>Prochain contrôle de routine : ${usefulInfoData.nextCheckup}</p>
                <p>Calendrier de vaccination : ${usefulInfoData.vaccinationSchedule}</p>
            `;

            // Charger et afficher les dossiers médicaux existants
            const medicalRecords = JSON.parse(localStorage.getItem('medicalRecords')) || [];
            const medicalRecordList = document.getElementById('medical-record-list');
            medicalRecords.forEach(record => {
                const recordItem = document.createElement('div');
                recordItem.className = 'record-item';
                recordItem.innerHTML = `<p>ID de l'Animal: ${record.animalId}</p>
                                        <p>Nom de l'Animal: ${record.animalName}</p>
                                        <p>Notes Médicales: ${record.medicalNotes}</p>
                                        <p>Date du Rendez-vous: ${record.appointmentDate}</p>
                                        <button onclick="deleteMedicalRecord(this)">Supprimer</button>`;
                medicalRecordList.appendChild(recordItem);
            });
        });
    </script>
</body>
</html>
